## Prepare Au(111) substrate

variable width            index 50.0
variable depth            index 50.0
variable height           index 30.0

variable xFactor          index 0.174   #factors for lattice
variable yFactor          index 0.150
variable zFactor          index 0.142

variable substrate_type             index 1        # type of electrode material
variable substrate_mass             index 196.9665 # mass of Au
variable substrate_lattice_constant index 4.075    # lattice constant of Au at standard conditions

variable cation_type                   index 2
variable cation_mass                   index 22.98977 # mass of Na

variable anion_type                    index 3
variable cation_mass                   index 35.45

# define crystal plane constants
#
# we orient the FCC crystal to have its 111 plane face positive z direction
# consequently, we choose the 1 -1 9 plane to face positive x
# and 1 1 -2 to face positive y
# 
# Now, crystal plane spacings d_hkl for a plane with Miller indices hkl and 
# FCC lattice constant a are related by
#
#   1 / d_hkl^2 = ( h^2 + k^2 + l^2 ) / a^2
# 
# or 
#
#   a = sqrt( h^2 + k^2 + l^2 ) * d_hkl
# 
# Thus, we have the following crystal plane spacings in our cartesian
# spatial directions
# 
#   d_(1,-1,0) = a/sqrt(2)
#   d_(1,1,-2) = a/sqrt(6)
#   d_(1,1,1)  = a/sqrt(3)

variable sqrtSumHKLx equal "sqrt(2.0)"
variable sqrtSumHKLy equal "sqrt(6.0)"
variable sqrtSumHKLz equal "sqrt(3.0)"


variable dx equal "v_substrate_lattice_constant / v_sqrtSumHKLx"
variable dy equal "v_substrate_lattice_constant / v_sqrtSumHKLy"
variable dz equal "v_substrate_lattice_constant / v_sqrtSumHKLz"

print "Crystal plane spacings: "
print "   (1,-1,0): ${dx}"
print "   (1,1,-2): ${dy}"
print "   (1,1,1):  ${dz}"

# now, we want every spatial measure to be an exact multiple of such 
# planar spacings. What is more, the structure only repeats
# at (2,1,3) multiples of planes.

variable dx_in_unit_cell equal 2
variable dy_in_unit_cell equal 1
variable dz_in_unit_cell equal 3

variable actual_width  equal "round(v_width  / (v_dx_in_unit_cell*v_dx))*v_dx_in_unit_cell*v_dx"
variable actual_depth  equal "round(v_depth  / (v_dy_in_unit_cell*v_dy))*v_dy_in_unit_cell*v_dy"
variable actual_height equal "round(v_height / (v_dz_in_unit_cell*v_dz))*v_dz_in_unit_cell*v_dz"

print "Measures of box corrected for whole crystal plane spacing multiples:"
print "  ${actual_width} ${actual_depth} ${actual_height}"

variable lat_width        equal "v_actual_width  * v_xFactor"
variable lat_depth        equal "v_actual_depth  * v_yFactor"
variable lat_height       equal "v_actual_height * v_zFactor"

print "Lattice measures of box: ${lat_width} ${lat_depth} ${lat_height}"

## System setup

dimension       3 
boundary        p p p
atom_style      full
units           real

lattice fcc ${substrate_lattice_constant} orient x 1 -1 0 orient y 1 1 -2 orient z 1 1 1
# doc: http://lammps.sandia.gov/doc/lattice.html


# here, we shift by 1/3rd of a lattice spacing in each direction to have no 
# atoms on the periodic boundaries:
region          box block $(v_dx/3.0) $(v_actual_width+(v_dx/3.0)) &
                          $(v_dy/3.0) $(v_actual_depth+(v_dy/3.0)) &
                          $(v_dz/2.0) $(v_actual_height+(v_dz/3.0)) units box

#region         box block x0 x1 y0 y1 z0 z1
#               |   |     |  |  |  |  |  |
#               ^name of region
#                    ^type of region (rectangular block)
#                         ^  ^start and end of that block in x-direction
#                               ^  ^start and end of that block in y-direction
#                                     ^  ^z-direction 
# doc: http://lammps.sandia.gov/doc/region.html

#CREATE BOX
# doc: http://lammps.sandia.gov/doc/create_box.html
boundary p p s
create_box      5 box &
                bond/types 1  &
                angle/types 1 &
                extra/bond/per/atom 2 &
                extra/angle/per/atom 1 &
                extra/special/per/atom 3

mass            ${substrate_type} ${substrate_mass}
mass 2 22.0
mass 3 35.0
mass 4 15.9994
mass 5 1.008



print "Initial box measures: $(xlo) $(xhi), $(ylo) $(yhi), $(zlo) $(zhi)"

# Fill this box with atoms
create_atoms    ${substrate_type} box
# doc: http://lammps.sandia.gov/doc/create_atoms.html

set type 1 charge 0.0


minimize 0.0 1.0e-6 10000 10000

# write data file
write_data      lower.electrode
#write_dump      all image substrate.png type type modify backcolor white
