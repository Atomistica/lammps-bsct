LAMMPS (26 Nov 2014)
# dimer test, C in charge transfer, Li not

# For two atoms with charges +- 0.5 and 3 A distance,
# energy = -1.2000 eV
# phi_{+-} = -+ 2.4

# 1 - init general

#processors 1 1 2

units		metal
atom_style	charge

# 2 - init system

boundary	p p p
read_data	data
  orthogonal box = (0 0 0) to (100 100 100)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms

# 3 - init potential

pair_style	coul/cut 10.0

pair_coeff      * *

# 4 - settings

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve

group           g_ct type 1
1 atoms in group g_ct

# BSCT
fix             ct g_ct bsct  nevery 1  qtot -0.5  log 3  mode 2  history 10 beta 0.1  prec 0.01  max_iter 100  type 1 0.0 8.0 10.0 2.0  coulcut 10.0
Initializing internal pair_style coul/cut/bsct.
Band structure charge transfer fix parameters:
  Update charges every 1 steps
  Logging level (0-3)  = 3
  Total charge = -0.500000
  Convergence criterion for |dG/dq_i| = 0.010000
  Short-range Coulomb cutoff = 10.0
  Convergence criterion for |dG/dq_i| = 0.010000
  Anderson mixing options:
    Mode = 2
    Maximum iterations = 100
    Mixing parameters:
       beta = 0.100000
       beta_max = 0.100000
       beta_mul = 1.000000
       history = 10
  Atom type parameters:
       type               X               U               V               p
          1         0.00000         8.00000        10.00000         2.00000

fix_modify	ct energy yes

thermo		1
thermo_style    custom step temp epair etotal f_ct elong ecoul
thermo_modify	format float %15.14g

timestep	0.000001

dump            1 all custom 1 custom.dump id q x y z f_ct

# 5 - run

run		15
Memory usage per processor = 3.41118 Mbytes
Step Temp E_pair TotEng ct E_long E_coul 
       0               0 -1.1999704166667 1.0500295833333            2.25               0 -1.1999704166667 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       1 1.3574351628618e-06 -1.1999704168421 1.0500295833333            2.25               0 -1.1999704168421 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       2 5.4297406546231e-06 -1.1999704173685 1.0500295833333            2.25               0 -1.1999704173685 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       3 1.2216916484811e-05 -1.1999704182458 1.0500295833333            2.25               0 -1.1999704182458 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       4 2.1718962669305e-05 -1.1999704194741 1.0500295833333            2.25               0 -1.1999704194741 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       5 3.3935879230336e-05 -1.1999704210532 1.0500295833333            2.25               0 -1.1999704210532 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       6 4.8867666196484e-05 -1.1999704229833 1.0500295833333            2.25               0 -1.1999704229833 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       7 6.6514323602686e-05 -1.1999704252643 1.0500295833333            2.25               0 -1.1999704252643 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       8 8.6875851490224e-05 -1.1999704278963 1.0500295833333            2.25               0 -1.1999704278963 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       9 0.00010995224990674 -1.1999704308791 1.0500295833333            2.25               0 -1.1999704308791 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      10 0.00013574351890621 -1.1999704342129 1.0500295833333            2.25               0 -1.1999704342129 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      11 0.00016424965854899 -1.1999704378976 1.0500295833333            2.25               0 -1.1999704378976 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      12 0.00019547066890177 -1.1999704419332 1.0500295833333            2.25               0 -1.1999704419332 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      13 0.00022940655003758 -1.1999704463198 1.0500295833333            2.25               0 -1.1999704463198 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      14 0.00026605730203582 -1.1999704510573 1.0500295833333            2.25               0 -1.1999704510573 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -1.199970
FixBSCT_fdf: Coulomb energy from sum of q*phi: -1.199970
                  CT      0         1.05003         0.00000         0.00000         0.50000         2.39994         0.10000
                  CT      0         1.05003         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      15 0.00030542292498225 -1.1999704561457 1.0500295833333            2.25               0 -1.1999704561457 
Loop time of 0 on 1 procs for 15 steps with 2 atoms

Pair  time (%) = 0 (0)
Neigh time (%) = 0 (0)
Comm  time (%) = 0 (0)
Outpt time (%) = 0 (0)
Other time (%) = 0 (0)

Nlocal:    2 ave 2 max 2 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1 ave 1 max 1 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1
Ave neighs/atom = 0.5
Neighbor list builds = 0
Dangerous builds = 0
