LAMMPS (26 Nov 2014)
# dimer test, C in charge transfer, Li not

# For two atoms with charges +- 0.5 and 3 A distance,
# energy = -1.2000 eV
# phi_{+-} = -+ 2.4

# 1 - init general

#processors 1 1 2

units		lj
atom_style	charge

# 2 - init system

boundary	f f f
read_data	data
  orthogonal box = (0 0 0) to (100 100 100)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms

# 3 - init potential

pair_style	coul/cut/bsct 10.0
pair_coeff      * *

# 4 - settings

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve

# BSCT
fix             ct all bsct  nevery 1  qtot 0.0  log 3  mode 2  history 10 beta 0.1  prec 0.0001  max_iter 100  type 1 1.0 0.1 0.1 2.0  type 2 -1.0 0.1 0.1 2.0 coulcut 10.0
Band structure charge transfer fix parameters:
  Update charges every 1 steps
  Logging level (0-3)  = 3
  Total charge = 0.000000
  Convergence criterion for |dG/dq_i| = 0.000100
  Short-range Coulomb cutoff = 10.0
  Convergence criterion for |dG/dq_i| = 0.000100
  Anderson mixing options:
    Mode = 2
    Maximum iterations = 100
    Mixing parameters:
       beta = 0.100000
       beta_max = 0.100000
       beta_mul = 1.000000
       history = 10
  Atom type parameters:
       type               X               U               V               p
          1         1.00000         0.10000         0.10000         2.00000
          2        -1.00000         0.10000         0.10000         2.00000

fix_modify	ct energy yes

thermo		1
thermo_style    custom step temp epair etotal f_ct elong ecoul
thermo_modify	format float %15.14g norm no

timestep	0.1

dump            1 all custom 1 dump.custom id type x y z q

# 5 - run

run		15
Memory usage per processor = 3.38829 Mbytes
Step Temp E_pair TotEng ct E_long E_coul 
       0               0 -0.083333333333333 -1.0333333333333           -0.95               0 -0.083333333333333 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -0.083334
FixBSCT_fdf: Coulomb energy from sum of q*phi: -0.083334
                  CT      0        -1.03333         1.06667         1.50850         0.50000         0.16667         0.10000
FixBSCT_fdf: Coulomb energy: -0.818159
FixBSCT_fdf: Coulomb energy from sum of q*phi: -0.818159
                  CT      1        -3.46061         1.20889         1.70964         1.56667         0.52223         0.10000
FixBSCT_fdf: Coulomb energy: -18.749211
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.749211
                  CT      2         7.49980         0.00000         0.00000         7.49980         2.49996         0.10000
                  CT      2         7.49980         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       1 0.007465470167126 -18.74921068527 7.5110008746212  26.24901335464               0 -18.74921068527 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -18.838627
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.838627
                  CT      0         7.41039         0.01192         0.01686         7.49980         2.51188         0.10000
FixBSCT_fdf: Coulomb energy: -18.898570
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.898570
                  CT      1         7.41008         0.01353         0.01914         7.51173         2.51588         0.10000
FixBSCT_fdf: Coulomb energy: -18.397328
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.397328
                  CT      2         7.41144         0.00000         0.00000         7.41144         2.48229         0.10000
                  CT      2         7.41144         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       2 0.066168466757816 -18.39732801928  7.510692560036 25.808767879179               0 -18.39732801928 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -18.573039
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.573039
                  CT      0         7.23573         0.02371         0.03353         7.41144         2.50600         0.10000
FixBSCT_fdf: Coulomb energy: -18.692053
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.692053
                  CT      1         7.23453         0.02698         0.03816         7.43515         2.51401         0.10000
FixBSCT_fdf: Coulomb energy: -17.722735
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.722735
                  CT      2         7.23980         0.00000         0.00000         7.23980         2.44796         0.10000
                  CT      2         7.23980         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       3 0.18021751385161 -17.722734550434 7.5101246645928 24.962532944249               0 -17.722734550434 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -17.977239
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.977239
                  CT      0         6.98529         0.03515         0.04971         7.23980         2.48311         0.10000
FixBSCT_fdf: Coulomb energy: -18.152244
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.152244
                  CT      1         6.98265         0.04018         0.05682         7.27495         2.49517         0.10000
FixBSCT_fdf: Coulomb energy: -16.776966
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.776966
                  CT      2         6.99394         0.00000         0.00000         6.99394         2.39879         0.10000
                  CT      2         6.99394         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       4 0.34362882201781 -16.776966168956 7.5093797635064 23.770902699435               0 -16.776966168956 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -17.099233
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.099233
                  CT      0         6.67167         0.04608         0.06516         6.99394         2.44487         0.10000
FixBSCT_fdf: Coulomb energy: -17.325284
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.325284
                  CT      1         6.66711         0.05297         0.07491         7.04001         2.46097         0.10000
FixBSCT_fdf: Coulomb energy: -15.626024
FixBSCT_fdf: Coulomb energy from sum of q*phi: -15.626024
                  CT      2         6.68587         0.00000         0.00000         6.68587         2.33717         0.10000
                  CT      2         6.68587         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       5 0.54845925945719 -15.626023579567 7.5085540034705 22.311888693851               0 -15.626023579567 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -16.002886
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.002886
                  CT      0         6.30900         0.05637         0.07972         6.68587         2.39354         0.10000
FixBSCT_fdf: Coulomb energy: -16.273857
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.273857
                  CT      1         6.30215         0.06527         0.09231         6.74223         2.41372         0.10000
FixBSCT_fdf: Coulomb energy: -14.340642
FixBSCT_fdf: Coulomb energy from sum of q*phi: -14.340642
                  CT      2         6.32911         0.00000         0.00000         6.32911         2.26582         0.10000
                  CT      2         6.32911         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       6 0.78575000410193 -14.340642209535 7.5077365723116 20.669753775694               0 -14.340642209535 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -14.758239
FixBSCT_fdf: Coulomb energy from sum of q*phi: -14.758239
                  CT      0         5.91151         0.06598         0.09331         6.32911         2.33180         0.10000
FixBSCT_fdf: Coulomb energy: -15.067549
FixBSCT_fdf: Coulomb energy from sum of q*phi: -15.067549
                  CT      1         5.90207         0.07709         0.10903         6.39509         2.35611         0.10000
FixBSCT_fdf: Coulomb energy: -12.987818
FixBSCT_fdf: Coulomb energy from sum of q*phi: -12.987818
                  CT      2         5.93736         0.00000         0.00000         5.93736         2.18747         0.10000
                  CT      2         5.93736         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       7  1.046422022359 -12.987817831737 7.5069957233062 18.925180521504               0 -12.987817831737 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -13.432812
FixBSCT_fdf: Coulomb energy from sum of q*phi: -13.432812
                  CT      0         5.49237         0.07495         0.10599         5.93736         2.26242         0.10000
FixBSCT_fdf: Coulomb energy: -13.774081
FixBSCT_fdf: Coulomb energy from sum of q*phi: -13.774081
                  CT      1         5.48012         0.08852         0.12518         6.01231         2.29098         0.10000
FixBSCT_fdf: Coulomb energy: -11.624971
FixBSCT_fdf: Coulomb energy from sum of q*phi: -11.624971
                  CT      2         5.52339         0.00000         0.00000         5.52339         2.10468         0.10000
                  CT      2         5.52339         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       8  1.321986059921 -11.624971249589 7.5063733995205 17.148365559228               0 -11.624971249589 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -12.085421
FixBSCT_fdf: Coulomb energy from sum of q*phi: -12.085421
                  CT      0         5.06294         0.08336         0.11789         5.52339         2.18804         0.10000
FixBSCT_fdf: Coulomb energy: -12.452979
FixBSCT_fdf: Coulomb energy from sum of q*phi: -12.452979
                  CT      1         5.04768         0.09971         0.14102         5.60676         2.22107         0.10000
FixBSCT_fdf: Coulomb energy: -10.297063
FixBSCT_fdf: Coulomb energy from sum of q*phi: -10.297063
                  CT      2         5.09838         0.00000         0.00000         5.09838         2.01968         0.10000
                  CT      2         5.09838         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       9 1.6050073711063 -10.297063294968 7.5058869669997 15.395439205308               0 -10.297063294968 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -10.762904
FixBSCT_fdf: Coulomb energy from sum of q*phi: -10.762904
                  CT      0         4.63254         0.09137         0.12922         5.09838         2.11105         0.10000
FixBSCT_fdf: Coulomb energy: -11.152134
FixBSCT_fdf: Coulomb energy from sum of q*phi: -11.152134
                  CT      1         4.61405         0.11093         0.15688         5.18975         2.14888         0.10000
FixBSCT_fdf: Coulomb energy: -9.036186
FixBSCT_fdf: Coulomb energy from sum of q*phi: -9.036186
                  CT      2         4.67154         0.00000         0.00000         4.67154         1.93431         0.10000
                  CT      2         4.67154         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      10 1.8893326180679 -9.0361858215852 7.5055349625636 13.707721857047               0 -9.0361858215852 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -9.499395
FixBSCT_fdf: Coulomb energy from sum of q*phi: -9.499395
                  CT      0         4.20833         0.09916         0.14023         4.67154         2.03346         0.10000
FixBSCT_fdf: Coulomb energy: -9.906933
FixBSCT_fdf: Coulomb energy from sum of q*phi: -9.906933
                  CT      1         4.18635         0.12249         0.17322         4.77069         2.07662         0.10000
FixBSCT_fdf: Coulomb energy: -7.862806
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.862806
                  CT      2         4.25011         0.00000         0.00000         4.25011         1.85002         0.10000
                  CT      2         4.25011         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      11 2.1701270909686 -7.8628058906007 7.5053039283173 12.112919182465               0 -7.8628058906007 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -8.317334
FixBSCT_fdf: Coulomb energy from sum of q*phi: -8.317334
                  CT      0         3.79558         0.10695         0.15124         4.25011         1.95697         0.10000
FixBSCT_fdf: Coulomb energy: -8.741177
FixBSCT_fdf: Coulomb energy from sum of q*phi: -8.741177
                  CT      1         3.76973         0.13480         0.19063         4.35706         2.00621         0.10000
FixBSCT_fdf: Coulomb energy: -6.787847
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.787847
                  CT      2         3.83950         0.00000         0.00000         3.83950         1.76790         0.10000
                  CT      2         3.83950         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      12 2.4437842840836 -6.7878470091448 7.5051744382494 10.627345021269               0 -6.7878470091448 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -7.229412
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.229412
                  CT      0         3.39793         0.11501         0.16264         3.83950         1.88291         0.10000
FixBSCT_fdf: Coulomb energy: -7.668989
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.668989
                  CT      1         3.36764         0.14840         0.20988         3.95450         1.93930         0.10000
FixBSCT_fdf: Coulomb energy: -5.814985
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.814985
                  CT      2         3.44348         0.00000         0.00000         3.44348         1.68870         0.10000
                  CT      2         3.44348         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      13 2.7077652063944 -5.8149854421109 7.5051255129698 9.2584631454891               0 -5.8149854421109 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -6.240804
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.240804
                  CT      0         3.01766         0.12366         0.17488         3.44348         1.81236         0.10000
FixBSCT_fdf: Coulomb energy: -6.697083
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.697083
                  CT      1         2.98209         0.16401         0.23195         3.56714         1.87744         0.10000
FixBSCT_fdf: Coulomb energy: -4.942777
FixBSCT_fdf: Coulomb energy from sum of q*phi: -4.942777
                  CT      2         3.06452         0.00000         0.00000         3.06452         1.61290         0.10000
                  CT      2         3.06452         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      14 2.9604113426987 -4.9427773659512 7.5051373734102 8.0072977253133               0 -4.9427773659512 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -5.351298
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.351298
                  CT      0         2.65600         0.13331         0.18852         3.06452         1.74621         0.10000
FixBSCT_fdf: Coulomb energy: -5.826986
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.826986
                  CT      1         2.61389         0.18261         0.25824         3.19783         1.82217         0.10000
FixBSCT_fdf: Coulomb energy: -4.166433
FixBSCT_fdf: Coulomb energy from sum of q*phi: -4.166433
                  CT      2         2.70405         0.00000         0.00000         2.70405         1.54081         0.10000
                  CT      2         2.70405         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      15 3.2007601404779 -4.1664327840844 7.5051928546111 6.8704854279786               0 -4.1664327840844 
Loop time of 0.0150011 on 1 procs for 15 steps with 2 atoms

Pair  time (%) = 0 (0)
Neigh time (%) = 0 (0)
Comm  time (%) = 0 (0)
Outpt time (%) = 0.00100017 (6.6673)
Other time (%) = 0.0140009 (93.3327)

Nlocal:    2 ave 2 max 2 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1 ave 1 max 1 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1
Ave neighs/atom = 0.5
Neighbor list builds = 1
Dangerous builds = 0
