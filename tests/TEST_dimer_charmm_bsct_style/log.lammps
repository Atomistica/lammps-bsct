LAMMPS (7 Aug 2019)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:93)
  using 1 OpenMP thread(s) per MPI task
# dimer test, C in charge transfer, Li not

# For two atoms with charges +- 0.5 and 3 A distance,
# energy = -1.2000 eV
# phi_{+-} = -+ 2.4

# 1 - init general

#processors 1 1 2

units		cgs # Use lj units because all physical constants=1
#units real
#units si
atom_style	charge

# 2 - init system

boundary	f f f
read_data	data
  orthogonal box = (0 0 0) to (100 100 100)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  read_data CPU = 0.00118816 secs

# 3 - init potential

# args: inner LJ cutoff, outer LJ cutoff, Coulomb cutoff
pair_style	lj/charmmfsw/coul/charmmfsh/bsct 8 12.0 10.0
pair_coeff      * * 0 0

# 4 - settings

neighbor	1.0 bin
neigh_modify	delay 0 every 1 check yes

fix		1 all nve

# BSCT
fix             ct all bsct  nevery 1  qtot 0.0  log 3  mode 2  history 10 beta 0.1  prec 0.0001  max_iter 100  type 1 1.0 0.1 0.1 2.0  type 2 -1.0 0.1 0.1 2.0
Band structure charge transfer fix parameters:
  Update charges every 1 steps
  Logging level (0-3)  = 3
  Total charge = 0.000000
  Convergence criterion for |dG/dq_i| = 0.000100
  Convergence criterion for |dG/dq_i| = 0.000100
  Anderson mixing options:
    Mode = 2
    Maximum iterations = 100
    Mixing parameters:
       beta = 0.100000
       beta_max = 0.100000
       beta_mul = 1.000000
       history = 10
  Atom type parameters:
       type               X               U               V               p
          1         1.00000         0.10000         0.10000         2.00000
          2        -1.00000         0.10000         0.10000         2.00000

fix_modify	ct energy yes

thermo		1
thermo_style    custom step temp epair etotal f_ct elong ecoul
thermo_modify	format float %15.14g norm no

timestep	0.1

dump            1 all custom 1 dump.custom id type x y z q f_ct

# 5 - run

run		15
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  binsize = 6.5, bins = 16 16 16
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/charmmfsh/bsct, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d/newton
      bin: standard
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -0.083333
FixBSCT_fdf: Coulomb energy from sum of q*phi: -0.083333
                  CT      0        -1.03333         1.06667         1.50849         0.50000         0.16667         0.10000
FixBSCT_fdf: Coulomb energy: -0.818148
FixBSCT_fdf: Coulomb energy from sum of q*phi: -0.818148
                  CT      1        -3.46059         1.20889         1.70963         1.56667         0.52222         0.10000
FixBSCT_fdf: Coulomb energy: -18.750000
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.750000
                  CT      2         7.50000         0.00000         0.00000         7.50000         2.50000         0.10000
                  CT      2         7.50000         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
Per MPI rank memory allocation (min/avg/max) = 4.193 | 4.193 | 4.193 Mbytes
Step Temp E_pair TotEng f_ct E_long E_coul 
       0               0         -9.1875         17.0625           26.25               0         -9.1875 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -18.790491
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.790491
                  CT      0         7.45951         0.00540         0.00764         7.50000         2.50540         0.10000
FixBSCT_fdf: Coulomb energy: -18.817554
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.817554
                  CT      1         7.45945         0.00612         0.00866         7.50540         2.50720         0.10000
FixBSCT_fdf: Coulomb energy: -18.589229
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.589229
                  CT      2         7.45973         0.00000         0.00000         7.45973         2.49195         0.10000
                  CT      2         7.45973         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       1 1.7647267281354e+14 -9.1255540773109 16.959947851151 26.048954868515               0 -9.1255540773109 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -18.709958
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.709958
                  CT      0         7.33900         0.01618         0.02289         7.45973         2.50813         0.10000
FixBSCT_fdf: Coulomb energy: -18.791229
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.791229
                  CT      1         7.33844         0.01839         0.02601         7.47591         2.51357         0.10000
FixBSCT_fdf: Coulomb energy: -18.118741
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.118741
                  CT      2         7.34092         0.00000         0.00000         7.34092         2.46818         0.10000
                  CT      2         7.34092         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       2 6.9754632572944e+14 -8.9437000462531 16.660421218183 25.459661122391               0 -8.9437000462531 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -18.315429
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.315429
                  CT      0         7.14423         0.02679         0.03789         7.34092         2.49498         0.10000
FixBSCT_fdf: Coulomb energy: -18.449371
FixBSCT_fdf: Coulomb energy from sum of q*phi: -18.449371
                  CT      1         7.14270         0.03054         0.04319         7.36771         2.50408         0.10000
FixBSCT_fdf: Coulomb energy: -17.372047
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.372047
                  CT      2         7.14936         0.00000         0.00000         7.14936         2.42987         0.10000
                  CT      2         7.14936         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       3 1.5392400642237e+15 -8.6532638084901 16.186920587736 24.521411534671               0 -8.6532638084901 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -17.636997
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.636997
                  CT      0         6.88441         0.03706         0.05241         7.14936         2.46693         0.10000
FixBSCT_fdf: Coulomb energy: -17.820316
FixBSCT_fdf: Coulomb energy from sum of q*phi: -17.820316
                  CT      1         6.88147         0.04243         0.06001         7.18642         2.47972         0.10000
FixBSCT_fdf: Coulomb energy: -16.399006
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.399006
                  CT      2         6.89388         0.00000         0.00000         6.89388         2.37878         0.10000
                  CT      2         6.89388         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       4 2.6648431793953e+15 -8.2712127004273 15.573558805784 23.292888985975               0 -8.2712127004273 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -16.722032
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.722032
                  CT      0         6.57086         0.04686         0.06627         6.89388         2.42563         0.10000
FixBSCT_fdf: Coulomb energy: -16.950119
FixBSCT_fdf: Coulomb energy from sum of q*phi: -16.950119
                  CT      1         6.56613         0.05397         0.07633         6.94074         2.44212         0.10000
FixBSCT_fdf: Coulomb energy: -15.258592
FixBSCT_fdf: Coulomb energy from sum of q*phi: -15.258592
                  CT      2         6.58532         0.00000         0.00000         6.58532         2.31706         0.10000
                  CT      2         6.58532         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       5 4.0290203556234e+15 -7.8178299351184 14.860478439111  21.84390808939               0 -7.8178299351184 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -15.628124
FixBSCT_fdf: Coulomb energy from sum of q*phi: -15.628124
                  CT      0         6.21578         0.05611         0.07936         6.58532         2.37318         0.10000
FixBSCT_fdf: Coulomb energy: -15.895598
FixBSCT_fdf: Coulomb energy from sum of q*phi: -15.895598
                  CT      1         6.20898         0.06511         0.09208         6.64143         2.39340         0.10000
FixBSCT_fdf: Coulomb energy: -14.011508
FixBSCT_fdf: Coulomb energy from sum of q*phi: -14.011508
                  CT      2         6.23542         0.00000         0.00000         6.23542         2.24708         0.10000
                  CT      2         6.23542         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       6 5.582284431502e+15 -7.3143097457447 14.088694275613 20.246926536368               0 -7.3143097457447 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -14.415666
FixBSCT_fdf: Coulomb energy from sum of q*phi: -14.415666
                  CT      0         5.83126         0.06482         0.09166         6.23542         2.31190         0.10000
FixBSCT_fdf: Coulomb energy: -14.716922
FixBSCT_fdf: Coulomb energy from sum of q*phi: -14.716922
                  CT      1         5.82214         0.07589         0.10732         6.30024         2.33593         0.10000
FixBSCT_fdf: Coulomb energy: -12.714087
FixBSCT_fdf: Coulomb energy from sum of q*phi: -12.714087
                  CT      2         5.85586         0.00000         0.00000         5.85586         2.17117         0.10000
                  CT      2         5.85586         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       7 7.2750851989064e+15 -6.7807270752003 13.295874528863 18.569949210578               0 -6.7807270752003 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -13.141568
FixBSCT_fdf: Coulomb energy from sum of q*phi: -13.141568
                  CT      0         5.42838         0.07300         0.10324         5.85586         2.24417         0.10000
FixBSCT_fdf: Coulomb energy: -13.471262
FixBSCT_fdf: Coulomb energy from sum of q*phi: -13.471262
                  CT      1         5.41675         0.08638         0.12216         5.92886         2.27215         0.10000
FixBSCT_fdf: Coulomb energy: -11.414248
FixBSCT_fdf: Coulomb energy from sum of q*phi: -11.414248
                  CT      2         5.45746         0.00000         0.00000         5.45746         2.09149         0.10000
                  CT      2         5.45746         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       8 9.0610145687333e+15 -6.2346349149491 12.513591272704 16.871712179344               0 -6.2346349149491 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -11.854945
FixBSCT_fdf: Coulomb energy from sum of q*phi: -11.854945
                  CT      0         5.01677         0.08075         0.11420         5.45746         2.17224         0.10000
FixBSCT_fdf: Coulomb energy: -12.208363
FixBSCT_fdf: Coulomb energy from sum of q*phi: -12.208363
                  CT      1         5.00243         0.09674         0.13681         5.53822         2.20439         0.10000
FixBSCT_fdf: Coulomb energy: -10.149580
FixBSCT_fdf: Coulomb energy from sum of q*phi: -10.149580
                  CT      2         5.04970         0.00000         0.00000         5.04970         2.00994         0.10000
                  CT      2         5.04970         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
       9 1.0898928783879e+16 -5.6903331643786 11.766083398291 15.199275004915               0 -5.6903331643786 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -10.594928
FixBSCT_fdf: Coulomb energy from sum of q*phi: -10.594928
                  CT      0         4.60435         0.08819         0.12472         5.04970         2.09813         0.10000
FixBSCT_fdf: Coulomb energy: -10.968241
FixBSCT_fdf: Coulomb energy from sum of q*phi: -10.968241
                  CT      1         4.58712         0.10720         0.15160         5.13789         2.13478         0.10000
FixBSCT_fdf: Coulomb energy: -8.947179
FixBSCT_fdf: Coulomb energy from sum of q*phi: -8.947179
                  CT      2         4.64044         0.00000         0.00000         4.64044         1.92809         0.10000
                  CT      2         4.64044         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      10 1.2754036538051e+16 -5.1587045252474 11.070245051143 13.587619729209               0 -5.1587045252474 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -9.390272
FixBSCT_fdf: Coulomb energy from sum of q*phi: -9.390272
                  CT      0         4.19735         0.09549         0.13504         4.64044         2.02357         0.10000
FixBSCT_fdf: Coulomb energy: -9.780691
FixBSCT_fdf: Coulomb energy from sum of q*phi: -9.780691
                  CT      1         4.17696         0.11803         0.16691         4.73593         2.06521         0.10000
FixBSCT_fdf: Coulomb energy: -7.824655
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.824655
                  CT      2         4.23597         0.00000         0.00000         4.23597         1.84719         0.10000
                  CT      2         4.23597         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      11 1.4598151414534e+16 -4.6474457504951 10.436418901547 12.060623113581               0 -4.6474457504951 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -8.260197
FixBSCT_fdf: Coulomb energy from sum of q*phi: -8.260197
                  CT      0         3.80043         0.10282         0.14541         4.23597         1.95001         0.10000
FixBSCT_fdf: Coulomb energy: -8.666065
FixBSCT_fdf: Coulomb energy from sum of q*phi: -8.666065
                  CT      1         3.77653         0.12959         0.18327         4.33879         1.99735         0.10000
FixBSCT_fdf: Coulomb energy: -6.791741
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.791741
                  CT      2         3.84103         0.00000         0.00000         3.84103         1.76821         0.10000
                  CT      2         3.84103         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      12 1.6409360472827e+16 -4.1615208111639 9.8695914847569 10.632773780838               0 -4.1615208111639 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -7.215894
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.215894
                  CT      0         3.41688         0.11043         0.15617         3.84103         1.87863         0.10000
FixBSCT_fdf: Coulomb energy: -7.636761
FixBSCT_fdf: Coulomb energy from sum of q*phi: -7.636761
                  CT      1         3.38897         0.14235         0.20131         3.95146         1.93264         0.10000
FixBSCT_fdf: Coulomb energy: -5.852080
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.852080
                  CT      2         3.45906         0.00000         0.00000         3.45906         1.69181         0.10000
                  CT      2         3.45906         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      13 1.8171346706091e+16 -3.7036973001262 9.3706842713863  9.311140006767               0 -3.7036973001262 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -6.262262
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.262262
                  CT      0         3.04888         0.11858         0.16770         3.45906         1.81039         0.10000
FixBSCT_fdf: Coulomb energy: -6.698982
FixBSCT_fdf: Coulomb energy from sum of q*phi: -6.698982
                  CT      1         3.01621         0.15693         0.22193         3.57764         1.87246         0.10000
FixBSCT_fdf: Coulomb energy: -5.004902
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.004902
                  CT      2         3.09236         0.00000         0.00000         3.09236         1.61847         0.10000
                  CT      2         3.09236         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      14 1.9872554616249e+16 -3.2750731945365 8.9377483014584 8.0972639240029               0 -3.2750731945365 
                  CT   ------------------------------------
                  CT   iter               G    max|dG/dq_i|         |dG/dq|        max|q_i|      max|phi_i|            beta
FixBSCT_fdf: Coulomb energy: -5.399582
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.399582
                  CT      0         2.69768         0.12763         0.18050         3.09236         1.74610         0.10000
FixBSCT_fdf: Coulomb energy: -5.854492
FixBSCT_fdf: Coulomb energy from sum of q*phi: -5.854492
                  CT      1         2.65916         0.17417         0.24632         3.21999         1.81817         0.10000
FixBSCT_fdf: Coulomb energy: -4.246454
FixBSCT_fdf: Coulomb energy from sum of q*phi: -4.246454
                  CT      2         2.74235         0.00000         0.00000         2.74235         1.54847         0.10000
                  CT      2         2.74235         0.00000         0.00000  <- minimum found
                  CT   ------------------------------------
      15 2.1505330863336e+16 -2.8755423974454 8.5669672901365 6.9888081387923               0 -2.8755423974454 
Loop time of 0.00107317 on 1 procs for 15 steps with 2 atoms

100.2% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.7139e-06 | 5.7139e-06 | 5.7139e-06 |   0.0 |  0.53
Neigh   | 1.0324e-05 | 1.0324e-05 | 1.0324e-05 |   0.0 |  0.96
Comm    | 4.033e-06  | 4.033e-06  | 4.033e-06  |   0.0 |  0.38
Output  | 0.00049951 | 0.00049951 | 0.00049951 |   0.0 | 46.55
Modify  | 0.00053694 | 0.00053694 | 0.00053694 |   0.0 | 50.03
Other   |            | 1.664e-05  |            |       |  1.55

Nlocal:    2 ave 2 max 2 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1 ave 1 max 1 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1
Ave neighs/atom = 0.5
Neighbor list builds = 1
Dangerous builds = 0
Total wall time: 0:00:00
